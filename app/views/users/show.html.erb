<div class="row padding-first-element">


  <img src="<%= (@user.photo.blank? ? asset_path('user-default.png') : @user.photo) %>"
       class="img-thumbnail rounded float-left profile-image col-lg-3 col-md-3 col-sm-4" alt="user profile image" />

  <div class="col-lg-3 col-md-3 col-sm-4">
    <ul class="list-group">
      <li class="list-group-item"><%= render 'follows/update', user: @user %></li>
      <% if @has_permission %>
          <li class="list-group-item">
            <%= link_to 'Editar Perfil', edit_user_path(@user)%>
          </li>
          <li class="list-group-item">
            <%= link_to 'Editar Contraseña', edit_user_password_path(@user) %>
          </li>
          <li class="list-group-item">
            <%= link_to 'Eliminar Usuario', @user, method: :delete, data: { confirm: 'Está seguro?' } %>
          </li>
      <% end %>

      <% if @can_grant_admin %>
          <li class="list-group-item">
            <%= link_to 'Dar permisos de administrador', grant_admin_path(@user), method: :patch, data: { confirm: 'Está seguro? Esto no se puede deshacer' } %>
          </li>
      <% elsif @can_revoke_admin %>
          <li class="list-group-item">
            <%= link_to 'Quitar permisos de administrador', revoke_admin_path(@user), method: :delete, data: { confirm: 'Está seguro? Esto no se puede deshacer' }%>
          </li>
      <% end %>
    </ul>
  </div>
</div>

<div class="row">
  <h1><%= @user.first_name + ' ' + @user.last_name %></h1>
  <p class="lead"><%= @user.email %></p>

  <% if @show_is_admin %>
      <div class="alert alert-warning">
        <h4>Precaución!</h4>
        <p>Este usuario tiene permisos de administrador.</p>
      </div>
    <strong>Este usuario tiene permisos de administrador</strong>
  <% end %>
</p>

<hr>

<%= render 'follows/update', user: @user %>

<h3> Siguiendo </h3>
<div class="col-lg-3 col-md-3 col-sm-4">
<% if @user_following.any? then %>
    <ul class="list-group">
      <% @user_following.each do |user_follows| %>
        <li>
          <%= link_to user_follows.followed.full_name, user_path(user_follows.followed) %>

          <%= @has_permission ?  (' | ' + link_to( 'Dejar de seguir', unfollow_path(current_user, user_follows.followed), method: :delete)) : '' %>

        </li>
    <% end %>
  <% else %>
      <p>
        No sigue a nadie.
      </p>
  <% end %>

<h3> Seguidores </h3>
<% if @user_followers.any? then %>
  <% @user_followers.each do |user_follower| %>
    <li>
      <%= link_to user_follower.follower.full_name, user_path(user_follower.follower) %>
    </li>
  <% end %>
<% else %>
    <p>
      No tiene.
    </p>
<% end %>


<%= render 'favorites/index',
  resource_name: 'canciones',
  favorite_items: @favorite_songs,
  item_path: Proc.new { |song| song_path(song) },
  remove_favorite_item_path: Proc.new { |user, song| remove_favorite_song_path(user, song) },
  is_female: true
  %>

<%= render 'favorites/index',
  resource_name: 'artistas',
  favorite_items: @favorite_artists,
  item_path: Proc.new { |artist| artist_path(artist) },
  remove_favorite_item_path: Proc.new { |user, artist| remove_favorite_artist_path(user, artist) }
  %>

<%= render 'favorites/index',
  resource_name: 'albums',
  favorite_items: @favorite_albums,
  item_path: Proc.new { |album| album_path(album) },
  remove_favorite_item_path: Proc.new { |user, album| remove_favorite_album_path(user, album) }
  %>

<h3>Artistas que ha creado el usuario:</h3>
<%= render 'artists/index-snippet', artists: @artists %>

<h3>Albums que ha creado el usuario:</h3>
<%= render 'albums/index-snippet', albums: @albums %>

<h3>Canciones que ha creado el usuario:</h3>
<%= render 'songs/index-snippet', songs: @songs %>

</div>

<div class="row">
  <%= render 'wall_messages/new' %>
  <%= render 'wall_messages/index' %>
  <hr>
</div>

<div class="row">

  <%= render 'favorites/index',
    resource_name: 'canciones',
    favorite_items: @favorite_songs,
    item_path: Proc.new { |song| song_path(song) },
    remove_favorite_item_path: Proc.new { |user, song| remove_favorite_song_path(user, song) },
    is_female: true
    %>

  <%= render 'favorites/index',
    resource_name: 'artistas',
    favorite_items: @favorite_artists,
    item_path: Proc.new { |artist| artist_path(artist) },
    remove_favorite_item_path: Proc.new { |user, artist| remove_favorite_artist_path(user, artist) }
    %>

  <%= render 'favorites/index',
    resource_name: 'albums',
    favorite_items: @favorite_albums,
    item_path: Proc.new { |album| album_path(album) },
    remove_favorite_item_path: Proc.new { |user, album| remove_favorite_album_path(user, album) }
    %>

  <h3>Artistas que ha creado el usuario:</h3>
  <%= render 'artists/index-snippet', artists: @artists %>

  <h3>Canciones que ha creado el usuario:</h3>
  <%= render 'songs/index-snippet', songs: @songs %>


</div>
